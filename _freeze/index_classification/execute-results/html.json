{
  "hash": "1e6e10574343d104c081c73da0301a54",
  "result": {
    "engine": "jupyter",
    "markdown": "---\ntitle: \"Clasificación Binaria con Logistic Regression\"\nformat:\n  html:\n    toc: true\nexecute:\n  warning: false\n  message: false\n  echo: true\n---\n\n## 1) Carga y exploración inicial\n\n::: {#0928af05 .cell execution_count=1}\n``` {.python .cell-code}\nimport pandas as pd\n\npath = \"data/ensanut_f1_informacion_general.csv\"\n\ndf = pd.read_csv(\n    path,\n    sep=None,                # autodetecta delimitador\n    engine=\"python\",         # necesario para sep=None\n    encoding=\"latin1\",       # o \"utf-8\"/\"cp1252\" si aplica\n    on_bad_lines=\"skip\",     # si hay filas mal formadas, sáltalas\n    skipinitialspace=True    # ignora espacios después del separador\n)\n\ndf.head()\n```\n\n::: {.cell-output .cell-output-display execution_count=1}\n```{=html}\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>ï»¿area</th>\n      <th>ciudad</th>\n      <th>zona</th>\n      <th>sector</th>\n      <th>vivienda</th>\n      <th>hogar</th>\n      <th>nciudad</th>\n      <th>regional</th>\n      <th>vo</th>\n      <th>tothog</th>\n      <th>...</th>\n      <th>if9a</th>\n      <th>if9b</th>\n      <th>if10</th>\n      <th>nf12</th>\n      <th>n1_flebo</th>\n      <th>n2_flebo</th>\n      <th>idhog</th>\n      <th>idviv</th>\n      <th>idsector</th>\n      <th>pw</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>urbano</td>\n      <td>cuenca</td>\n      <td>1</td>\n      <td>1</td>\n      <td>1</td>\n      <td>1</td>\n      <td>CUENCA</td>\n      <td>sur</td>\n      <td>4</td>\n      <td>1</td>\n      <td>...</td>\n      <td>si</td>\n      <td>2.0</td>\n      <td>4.0</td>\n      <td>2.0</td>\n      <td>4402.0</td>\n      <td>4402.0</td>\n      <td>10150001001011</td>\n      <td>1015000100101</td>\n      <td>10150001001</td>\n      <td>274,240540540541</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>urbano</td>\n      <td>cuenca</td>\n      <td>1</td>\n      <td>1</td>\n      <td>2</td>\n      <td>1</td>\n      <td>CUENCA</td>\n      <td>sur</td>\n      <td>11</td>\n      <td>1</td>\n      <td>...</td>\n      <td>no</td>\n      <td>NaN</td>\n      <td>2.0</td>\n      <td>0.0</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>10150001001021</td>\n      <td>1015000100102</td>\n      <td>10150001001</td>\n      <td>274,240540540541</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>urbano</td>\n      <td>cuenca</td>\n      <td>1</td>\n      <td>1</td>\n      <td>3</td>\n      <td>1</td>\n      <td>CUENCA</td>\n      <td>sur</td>\n      <td>12</td>\n      <td>1</td>\n      <td>...</td>\n      <td>si</td>\n      <td>1.0</td>\n      <td>3.0</td>\n      <td>2.0</td>\n      <td>4202.0</td>\n      <td>4202.0</td>\n      <td>10150001001031</td>\n      <td>1015000100103</td>\n      <td>10150001001</td>\n      <td>274,240540540541</td>\n    </tr>\n    <tr>\n      <th>3</th>\n      <td>urbano</td>\n      <td>cuenca</td>\n      <td>1</td>\n      <td>1</td>\n      <td>5</td>\n      <td>1</td>\n      <td>CUENCA</td>\n      <td>sur</td>\n      <td>7</td>\n      <td>1</td>\n      <td>...</td>\n      <td>si</td>\n      <td>1.0</td>\n      <td>3.0</td>\n      <td>1.0</td>\n      <td>4401.0</td>\n      <td>4401.0</td>\n      <td>10150001001051</td>\n      <td>1015000100105</td>\n      <td>10150001001</td>\n      <td>274,240540540541</td>\n    </tr>\n    <tr>\n      <th>4</th>\n      <td>urbano</td>\n      <td>cuenca</td>\n      <td>1</td>\n      <td>1</td>\n      <td>6</td>\n      <td>1</td>\n      <td>CUENCA</td>\n      <td>sur</td>\n      <td>8</td>\n      <td>1</td>\n      <td>...</td>\n      <td>no</td>\n      <td>NaN</td>\n      <td>1.0</td>\n      <td>0.0</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>10150001001061</td>\n      <td>1015000100106</td>\n      <td>10150001001</td>\n      <td>274,240540540541</td>\n    </tr>\n  </tbody>\n</table>\n<p>5 rows × 59 columns</p>\n</div>\n```\n:::\n:::\n\n\n::: {#baf955d8 .cell execution_count=2}\n``` {.python .cell-code}\ndf.info()\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n<class 'pandas.core.frame.DataFrame'>\nRangeIndex: 23265 entries, 0 to 23264\nData columns (total 59 columns):\n #   Column    Non-Null Count  Dtype  \n---  ------    --------------  -----  \n 0   ï»¿area   23265 non-null  object \n 1   ciudad    23265 non-null  object \n 2   zona      23265 non-null  int64  \n 3   sector    23265 non-null  int64  \n 4   vivienda  23265 non-null  int64  \n 5   hogar     23265 non-null  int64  \n 6   nciudad   23265 non-null  object \n 7   regional  23232 non-null  object \n 8   vo        23265 non-null  int64  \n 9   tothog    23265 non-null  int64  \n 10  altitud   23265 non-null  object \n 11  resultad  23265 non-null  object \n 12  informa   19954 non-null  object \n 13  parentes  19954 non-null  object \n 14  codsup    23265 non-null  object \n 15  codenc    23265 non-null  object \n 16  codcod    23265 non-null  object \n 17  coddig    23265 non-null  int64  \n 18  supere1   23265 non-null  object \n 19  supere2   23265 non-null  object \n 20  supere3   23265 non-null  object \n 21  superr1   23265 non-null  object \n 22  superr2   23265 non-null  object \n 23  superr3   23265 non-null  object \n 24  supern1   23265 non-null  object \n 25  supern2   23265 non-null  object \n 26  supern3   23265 non-null  object \n 27  dia       23265 non-null  object \n 28  mes       23265 non-null  object \n 29  anio      23265 non-null  object \n 30  numpers   19949 non-null  float64\n 31  mi00a     19949 non-null  object \n 32  mi00b     295 non-null    float64\n 33  mo00a     19949 non-null  object \n 34  mo00b     308 non-null    float64\n 35  if2       19949 non-null  object \n 36  if3a      19949 non-null  object \n 37  if3b      5831 non-null   float64\n 38  if4a      19949 non-null  object \n 39  if4b      8205 non-null   float64\n 40  if4o      8205 non-null   float64\n 41  if5a      19949 non-null  object \n 42  if5b      8073 non-null   float64\n 43  if6a      19949 non-null  object \n 44  if6b      10606 non-null  float64\n 45  if7a      19949 non-null  object \n 46  if7b      19154 non-null  float64\n 47  if8a      19949 non-null  object \n 48  if8b      11937 non-null  float64\n 49  if9a      19949 non-null  object \n 50  if9b      13839 non-null  float64\n 51  if10      19949 non-null  float64\n 52  nf12      19949 non-null  float64\n 53  n1_flebo  10019 non-null  float64\n 54  n2_flebo  10019 non-null  float64\n 55  idhog     23265 non-null  int64  \n 56  idviv     23265 non-null  int64  \n 57  idsector  23265 non-null  int64  \n 58  pw        19949 non-null  object \ndtypes: float64(15), int64(10), object(34)\nmemory usage: 10.5+ MB\n```\n:::\n:::\n\n\n::: {#5463a1c7 .cell execution_count=3}\n``` {.python .cell-code}\n# Porcentaje de faltantes por columna (top 15)\ndf.isna().mean().sort_values(ascending=False).head(15)\n```\n\n::: {.cell-output .cell-output-display execution_count=3}\n```\nmi00b       0.987320\nmo00b       0.986761\nif3b        0.749366\nif5b        0.652998\nif4o        0.647324\nif4b        0.647324\nn2_flebo    0.569353\nn1_flebo    0.569353\nif6b        0.544122\nif8b        0.486912\nif9b        0.405158\nif7b        0.176703\nnumpers     0.142532\nif3a        0.142532\nif4a        0.142532\ndtype: float64\n```\n:::\n:::\n\n\n## 2) Selección de variable objetivo (binaria) y EDA breve\n\n> Puedes fijar manualmente la columna objetivo asignando `TARGET = \"nombre_columna\"`.\n> Si lo dejas vacío, el notebook intentará **detectar** la primera columna categórica binaria.\n\n::: {#32ae8c35 .cell execution_count=4}\n``` {.python .cell-code}\nimport numpy as np\n\nTARGET = \"\"  # <- opcional: pon aquí tu columna binaria (str). Si la dejas en \"\", se detecta automáticamente.\n\n# Detectar objetivo binario si no se especifica\ntarget_col = TARGET.strip() if isinstance(TARGET, str) and TARGET.strip() else None\nif target_col is None:\n    # candidata: columna con exactamente 2 valores distintos (ignorando NaN)\n    for c in df.columns:\n        nun = df[c].dropna().nunique()\n        if nun == 2:\n            target_col = c\n            break\n\nif target_col is None:\n    raise ValueError(\"No se detectó una columna binaria automáticamente. Define TARGET con el nombre de tu variable objetivo.\")\n\n# Asegurar que el objetivo sea categórico (0/1 o etiquetas)\ny_raw = df[target_col]\n\n# Mostrar distribución de clases\ny_raw.value_counts(dropna=False)\n```\n\n::: {.cell-output .cell-output-display execution_count=4}\n```\nï»¿area\nurbano    14122\nrural      9143\nName: count, dtype: int64\n```\n:::\n:::\n\n\n::: {#ce6857ba .cell execution_count=5}\n``` {.python .cell-code}\nimport matplotlib.pyplot as plt\n\nvc = y_raw.value_counts()\nplt.figure()\nvc.plot(kind=\"bar\")\nplt.title(f\"Distribución de clases - {target_col}\")\nplt.xlabel(\"Clase\")\nplt.ylabel(\"Frecuencia\")\nplt.tight_layout()\nplt.show()\n```\n\n::: {.cell-output .cell-output-display}\n![](index_classification_files/figure-html/cell-6-output-1.png){width=662 height=470}\n:::\n:::\n\n\n## 3) División Train/Test y preparación de datos\n\n::: {#271cc3ee .cell execution_count=6}\n``` {.python .cell-code}\nfrom sklearn.model_selection import train_test_split\nfrom sklearn.compose import ColumnTransformer\nfrom sklearn.pipeline import Pipeline\nfrom sklearn.preprocessing import OneHotEncoder, StandardScaler\nfrom sklearn.impute import SimpleImputer\n\n# Separar X e y\nX = df.drop(columns=[target_col])\ny = y_raw\n\n# Detectar tipos\nnum_cols = [c for c in X.columns if pd.api.types.is_numeric_dtype(X[c])]\ncat_cols = [c for c in X.columns if c not in num_cols]\n\nlen(num_cols), len(cat_cols)\n```\n\n::: {.cell-output .cell-output-display execution_count=6}\n```\n(25, 33)\n```\n:::\n:::\n\n\n::: {#8b7ea4cf .cell execution_count=7}\n``` {.python .cell-code}\n# División estratificada para mantener la proporción de clases\nX_train, X_test, y_train, y_test = train_test_split(\n    X, y, test_size=0.2, random_state=42, stratify=y\n)\n\n# Transformaciones: imputación + escalado para numéricas; imputación + OneHot para categóricas\nnum_transformer = Pipeline(steps=[\n    (\"imputer\", SimpleImputer(strategy=\"median\")),\n    (\"scaler\", StandardScaler())\n])\n\n# Para scikit-learn >= 1.2: usar sparse_output=False\ncat_transformer = Pipeline(steps=[\n    (\"imputer\", SimpleImputer(strategy=\"most_frequent\")),\n    (\"onehot\", OneHotEncoder(handle_unknown=\"ignore\", sparse_output=False, max_categories=50))\n])\n\npreprocessor = ColumnTransformer(transformers=[\n    (\"num\", num_transformer, num_cols),\n    (\"cat\", cat_transformer, cat_cols)\n])\n```\n:::\n\n\n## 4) Modelo: Logistic Regression (Pipeline) y entrenamiento\n\n::: {#eadb8be9 .cell execution_count=8}\n``` {.python .cell-code}\nfrom sklearn.linear_model import LogisticRegression\n\n# Modelo base (ajustable)\nlogreg = LogisticRegression(max_iter=1000, solver=\"lbfgs\")\n\nmodel = Pipeline(steps=[\n    (\"prep\", preprocessor),\n    (\"clf\", logreg)\n])\n\nmodel.fit(X_train, y_train)\n```\n\n::: {.cell-output .cell-output-display execution_count=8}\n```{=html}\n<style>#sk-container-id-1 {\n  /* Definition of color scheme common for light and dark mode */\n  --sklearn-color-text: #000;\n  --sklearn-color-text-muted: #666;\n  --sklearn-color-line: gray;\n  /* Definition of color scheme for unfitted estimators */\n  --sklearn-color-unfitted-level-0: #fff5e6;\n  --sklearn-color-unfitted-level-1: #f6e4d2;\n  --sklearn-color-unfitted-level-2: #ffe0b3;\n  --sklearn-color-unfitted-level-3: chocolate;\n  /* Definition of color scheme for fitted estimators */\n  --sklearn-color-fitted-level-0: #f0f8ff;\n  --sklearn-color-fitted-level-1: #d4ebff;\n  --sklearn-color-fitted-level-2: #b3dbfd;\n  --sklearn-color-fitted-level-3: cornflowerblue;\n\n  /* Specific color for light theme */\n  --sklearn-color-text-on-default-background: var(--sg-text-color, var(--theme-code-foreground, var(--jp-content-font-color1, black)));\n  --sklearn-color-background: var(--sg-background-color, var(--theme-background, var(--jp-layout-color0, white)));\n  --sklearn-color-border-box: var(--sg-text-color, var(--theme-code-foreground, var(--jp-content-font-color1, black)));\n  --sklearn-color-icon: #696969;\n\n  @media (prefers-color-scheme: dark) {\n    /* Redefinition of color scheme for dark theme */\n    --sklearn-color-text-on-default-background: var(--sg-text-color, var(--theme-code-foreground, var(--jp-content-font-color1, white)));\n    --sklearn-color-background: var(--sg-background-color, var(--theme-background, var(--jp-layout-color0, #111)));\n    --sklearn-color-border-box: var(--sg-text-color, var(--theme-code-foreground, var(--jp-content-font-color1, white)));\n    --sklearn-color-icon: #878787;\n  }\n}\n\n#sk-container-id-1 {\n  color: var(--sklearn-color-text);\n}\n\n#sk-container-id-1 pre {\n  padding: 0;\n}\n\n#sk-container-id-1 input.sk-hidden--visually {\n  border: 0;\n  clip: rect(1px 1px 1px 1px);\n  clip: rect(1px, 1px, 1px, 1px);\n  height: 1px;\n  margin: -1px;\n  overflow: hidden;\n  padding: 0;\n  position: absolute;\n  width: 1px;\n}\n\n#sk-container-id-1 div.sk-dashed-wrapped {\n  border: 1px dashed var(--sklearn-color-line);\n  margin: 0 0.4em 0.5em 0.4em;\n  box-sizing: border-box;\n  padding-bottom: 0.4em;\n  background-color: var(--sklearn-color-background);\n}\n\n#sk-container-id-1 div.sk-container {\n  /* jupyter's `normalize.less` sets `[hidden] { display: none; }`\n     but bootstrap.min.css set `[hidden] { display: none !important; }`\n     so we also need the `!important` here to be able to override the\n     default hidden behavior on the sphinx rendered scikit-learn.org.\n     See: https://github.com/scikit-learn/scikit-learn/issues/21755 */\n  display: inline-block !important;\n  position: relative;\n}\n\n#sk-container-id-1 div.sk-text-repr-fallback {\n  display: none;\n}\n\ndiv.sk-parallel-item,\ndiv.sk-serial,\ndiv.sk-item {\n  /* draw centered vertical line to link estimators */\n  background-image: linear-gradient(var(--sklearn-color-text-on-default-background), var(--sklearn-color-text-on-default-background));\n  background-size: 2px 100%;\n  background-repeat: no-repeat;\n  background-position: center center;\n}\n\n/* Parallel-specific style estimator block */\n\n#sk-container-id-1 div.sk-parallel-item::after {\n  content: \"\";\n  width: 100%;\n  border-bottom: 2px solid var(--sklearn-color-text-on-default-background);\n  flex-grow: 1;\n}\n\n#sk-container-id-1 div.sk-parallel {\n  display: flex;\n  align-items: stretch;\n  justify-content: center;\n  background-color: var(--sklearn-color-background);\n  position: relative;\n}\n\n#sk-container-id-1 div.sk-parallel-item {\n  display: flex;\n  flex-direction: column;\n}\n\n#sk-container-id-1 div.sk-parallel-item:first-child::after {\n  align-self: flex-end;\n  width: 50%;\n}\n\n#sk-container-id-1 div.sk-parallel-item:last-child::after {\n  align-self: flex-start;\n  width: 50%;\n}\n\n#sk-container-id-1 div.sk-parallel-item:only-child::after {\n  width: 0;\n}\n\n/* Serial-specific style estimator block */\n\n#sk-container-id-1 div.sk-serial {\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  background-color: var(--sklearn-color-background);\n  padding-right: 1em;\n  padding-left: 1em;\n}\n\n\n/* Toggleable style: style used for estimator/Pipeline/ColumnTransformer box that is\nclickable and can be expanded/collapsed.\n- Pipeline and ColumnTransformer use this feature and define the default style\n- Estimators will overwrite some part of the style using the `sk-estimator` class\n*/\n\n/* Pipeline and ColumnTransformer style (default) */\n\n#sk-container-id-1 div.sk-toggleable {\n  /* Default theme specific background. It is overwritten whether we have a\n  specific estimator or a Pipeline/ColumnTransformer */\n  background-color: var(--sklearn-color-background);\n}\n\n/* Toggleable label */\n#sk-container-id-1 label.sk-toggleable__label {\n  cursor: pointer;\n  display: flex;\n  width: 100%;\n  margin-bottom: 0;\n  padding: 0.5em;\n  box-sizing: border-box;\n  text-align: center;\n  align-items: start;\n  justify-content: space-between;\n  gap: 0.5em;\n}\n\n#sk-container-id-1 label.sk-toggleable__label .caption {\n  font-size: 0.6rem;\n  font-weight: lighter;\n  color: var(--sklearn-color-text-muted);\n}\n\n#sk-container-id-1 label.sk-toggleable__label-arrow:before {\n  /* Arrow on the left of the label */\n  content: \"▸\";\n  float: left;\n  margin-right: 0.25em;\n  color: var(--sklearn-color-icon);\n}\n\n#sk-container-id-1 label.sk-toggleable__label-arrow:hover:before {\n  color: var(--sklearn-color-text);\n}\n\n/* Toggleable content - dropdown */\n\n#sk-container-id-1 div.sk-toggleable__content {\n  display: none;\n  text-align: left;\n  /* unfitted */\n  background-color: var(--sklearn-color-unfitted-level-0);\n}\n\n#sk-container-id-1 div.sk-toggleable__content.fitted {\n  /* fitted */\n  background-color: var(--sklearn-color-fitted-level-0);\n}\n\n#sk-container-id-1 div.sk-toggleable__content pre {\n  margin: 0.2em;\n  border-radius: 0.25em;\n  color: var(--sklearn-color-text);\n  /* unfitted */\n  background-color: var(--sklearn-color-unfitted-level-0);\n}\n\n#sk-container-id-1 div.sk-toggleable__content.fitted pre {\n  /* unfitted */\n  background-color: var(--sklearn-color-fitted-level-0);\n}\n\n#sk-container-id-1 input.sk-toggleable__control:checked~div.sk-toggleable__content {\n  /* Expand drop-down */\n  display: block;\n  width: 100%;\n  overflow: visible;\n}\n\n#sk-container-id-1 input.sk-toggleable__control:checked~label.sk-toggleable__label-arrow:before {\n  content: \"▾\";\n}\n\n/* Pipeline/ColumnTransformer-specific style */\n\n#sk-container-id-1 div.sk-label input.sk-toggleable__control:checked~label.sk-toggleable__label {\n  color: var(--sklearn-color-text);\n  background-color: var(--sklearn-color-unfitted-level-2);\n}\n\n#sk-container-id-1 div.sk-label.fitted input.sk-toggleable__control:checked~label.sk-toggleable__label {\n  background-color: var(--sklearn-color-fitted-level-2);\n}\n\n/* Estimator-specific style */\n\n/* Colorize estimator box */\n#sk-container-id-1 div.sk-estimator input.sk-toggleable__control:checked~label.sk-toggleable__label {\n  /* unfitted */\n  background-color: var(--sklearn-color-unfitted-level-2);\n}\n\n#sk-container-id-1 div.sk-estimator.fitted input.sk-toggleable__control:checked~label.sk-toggleable__label {\n  /* fitted */\n  background-color: var(--sklearn-color-fitted-level-2);\n}\n\n#sk-container-id-1 div.sk-label label.sk-toggleable__label,\n#sk-container-id-1 div.sk-label label {\n  /* The background is the default theme color */\n  color: var(--sklearn-color-text-on-default-background);\n}\n\n/* On hover, darken the color of the background */\n#sk-container-id-1 div.sk-label:hover label.sk-toggleable__label {\n  color: var(--sklearn-color-text);\n  background-color: var(--sklearn-color-unfitted-level-2);\n}\n\n/* Label box, darken color on hover, fitted */\n#sk-container-id-1 div.sk-label.fitted:hover label.sk-toggleable__label.fitted {\n  color: var(--sklearn-color-text);\n  background-color: var(--sklearn-color-fitted-level-2);\n}\n\n/* Estimator label */\n\n#sk-container-id-1 div.sk-label label {\n  font-family: monospace;\n  font-weight: bold;\n  display: inline-block;\n  line-height: 1.2em;\n}\n\n#sk-container-id-1 div.sk-label-container {\n  text-align: center;\n}\n\n/* Estimator-specific */\n#sk-container-id-1 div.sk-estimator {\n  font-family: monospace;\n  border: 1px dotted var(--sklearn-color-border-box);\n  border-radius: 0.25em;\n  box-sizing: border-box;\n  margin-bottom: 0.5em;\n  /* unfitted */\n  background-color: var(--sklearn-color-unfitted-level-0);\n}\n\n#sk-container-id-1 div.sk-estimator.fitted {\n  /* fitted */\n  background-color: var(--sklearn-color-fitted-level-0);\n}\n\n/* on hover */\n#sk-container-id-1 div.sk-estimator:hover {\n  /* unfitted */\n  background-color: var(--sklearn-color-unfitted-level-2);\n}\n\n#sk-container-id-1 div.sk-estimator.fitted:hover {\n  /* fitted */\n  background-color: var(--sklearn-color-fitted-level-2);\n}\n\n/* Specification for estimator info (e.g. \"i\" and \"?\") */\n\n/* Common style for \"i\" and \"?\" */\n\n.sk-estimator-doc-link,\na:link.sk-estimator-doc-link,\na:visited.sk-estimator-doc-link {\n  float: right;\n  font-size: smaller;\n  line-height: 1em;\n  font-family: monospace;\n  background-color: var(--sklearn-color-background);\n  border-radius: 1em;\n  height: 1em;\n  width: 1em;\n  text-decoration: none !important;\n  margin-left: 0.5em;\n  text-align: center;\n  /* unfitted */\n  border: var(--sklearn-color-unfitted-level-1) 1pt solid;\n  color: var(--sklearn-color-unfitted-level-1);\n}\n\n.sk-estimator-doc-link.fitted,\na:link.sk-estimator-doc-link.fitted,\na:visited.sk-estimator-doc-link.fitted {\n  /* fitted */\n  border: var(--sklearn-color-fitted-level-1) 1pt solid;\n  color: var(--sklearn-color-fitted-level-1);\n}\n\n/* On hover */\ndiv.sk-estimator:hover .sk-estimator-doc-link:hover,\n.sk-estimator-doc-link:hover,\ndiv.sk-label-container:hover .sk-estimator-doc-link:hover,\n.sk-estimator-doc-link:hover {\n  /* unfitted */\n  background-color: var(--sklearn-color-unfitted-level-3);\n  color: var(--sklearn-color-background);\n  text-decoration: none;\n}\n\ndiv.sk-estimator.fitted:hover .sk-estimator-doc-link.fitted:hover,\n.sk-estimator-doc-link.fitted:hover,\ndiv.sk-label-container:hover .sk-estimator-doc-link.fitted:hover,\n.sk-estimator-doc-link.fitted:hover {\n  /* fitted */\n  background-color: var(--sklearn-color-fitted-level-3);\n  color: var(--sklearn-color-background);\n  text-decoration: none;\n}\n\n/* Span, style for the box shown on hovering the info icon */\n.sk-estimator-doc-link span {\n  display: none;\n  z-index: 9999;\n  position: relative;\n  font-weight: normal;\n  right: .2ex;\n  padding: .5ex;\n  margin: .5ex;\n  width: min-content;\n  min-width: 20ex;\n  max-width: 50ex;\n  color: var(--sklearn-color-text);\n  box-shadow: 2pt 2pt 4pt #999;\n  /* unfitted */\n  background: var(--sklearn-color-unfitted-level-0);\n  border: .5pt solid var(--sklearn-color-unfitted-level-3);\n}\n\n.sk-estimator-doc-link.fitted span {\n  /* fitted */\n  background: var(--sklearn-color-fitted-level-0);\n  border: var(--sklearn-color-fitted-level-3);\n}\n\n.sk-estimator-doc-link:hover span {\n  display: block;\n}\n\n/* \"?\"-specific style due to the `<a>` HTML tag */\n\n#sk-container-id-1 a.estimator_doc_link {\n  float: right;\n  font-size: 1rem;\n  line-height: 1em;\n  font-family: monospace;\n  background-color: var(--sklearn-color-background);\n  border-radius: 1rem;\n  height: 1rem;\n  width: 1rem;\n  text-decoration: none;\n  /* unfitted */\n  color: var(--sklearn-color-unfitted-level-1);\n  border: var(--sklearn-color-unfitted-level-1) 1pt solid;\n}\n\n#sk-container-id-1 a.estimator_doc_link.fitted {\n  /* fitted */\n  border: var(--sklearn-color-fitted-level-1) 1pt solid;\n  color: var(--sklearn-color-fitted-level-1);\n}\n\n/* On hover */\n#sk-container-id-1 a.estimator_doc_link:hover {\n  /* unfitted */\n  background-color: var(--sklearn-color-unfitted-level-3);\n  color: var(--sklearn-color-background);\n  text-decoration: none;\n}\n\n#sk-container-id-1 a.estimator_doc_link.fitted:hover {\n  /* fitted */\n  background-color: var(--sklearn-color-fitted-level-3);\n}\n\n.estimator-table summary {\n    padding: .5rem;\n    font-family: monospace;\n    cursor: pointer;\n}\n\n.estimator-table details[open] {\n    padding-left: 0.1rem;\n    padding-right: 0.1rem;\n    padding-bottom: 0.3rem;\n}\n\n.estimator-table .parameters-table {\n    margin-left: auto !important;\n    margin-right: auto !important;\n}\n\n.estimator-table .parameters-table tr:nth-child(odd) {\n    background-color: #fff;\n}\n\n.estimator-table .parameters-table tr:nth-child(even) {\n    background-color: #f6f6f6;\n}\n\n.estimator-table .parameters-table tr:hover {\n    background-color: #e0e0e0;\n}\n\n.estimator-table table td {\n    border: 1px solid rgba(106, 105, 104, 0.232);\n}\n\n.user-set td {\n    color:rgb(255, 94, 0);\n    text-align: left;\n}\n\n.user-set td.value pre {\n    color:rgb(255, 94, 0) !important;\n    background-color: transparent !important;\n}\n\n.default td {\n    color: black;\n    text-align: left;\n}\n\n.user-set td i,\n.default td i {\n    color: black;\n}\n\n.copy-paste-icon {\n    background-image: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA0NDggNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNy4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjUgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTIwOCAwTDMzMi4xIDBjMTIuNyAwIDI0LjkgNS4xIDMzLjkgMTQuMWw2Ny45IDY3LjljOSA5IDE0LjEgMjEuMiAxNC4xIDMzLjlMNDQ4IDMzNmMwIDI2LjUtMjEuNSA0OC00OCA0OGwtMTkyIDBjLTI2LjUgMC00OC0yMS41LTQ4LTQ4bDAtMjg4YzAtMjYuNSAyMS41LTQ4IDQ4LTQ4ek00OCAxMjhsODAgMCAwIDY0LTY0IDAgMCAyNTYgMTkyIDAgMC0zMiA2NCAwIDAgNDhjMCAyNi41LTIxLjUgNDgtNDggNDhMNDggNTEyYy0yNi41IDAtNDgtMjEuNS00OC00OEwwIDE3NmMwLTI2LjUgMjEuNS00OCA0OC00OHoiLz48L3N2Zz4=);\n    background-repeat: no-repeat;\n    background-size: 14px 14px;\n    background-position: 0;\n    display: inline-block;\n    width: 14px;\n    height: 14px;\n    cursor: pointer;\n}\n</style><body><div id=\"sk-container-id-1\" class=\"sk-top-container\"><div class=\"sk-text-repr-fallback\"><pre>Pipeline(steps=[(&#x27;prep&#x27;,\n                 ColumnTransformer(transformers=[(&#x27;num&#x27;,\n                                                  Pipeline(steps=[(&#x27;imputer&#x27;,\n                                                                   SimpleImputer(strategy=&#x27;median&#x27;)),\n                                                                  (&#x27;scaler&#x27;,\n                                                                   StandardScaler())]),\n                                                  [&#x27;zona&#x27;, &#x27;sector&#x27;, &#x27;vivienda&#x27;,\n                                                   &#x27;hogar&#x27;, &#x27;vo&#x27;, &#x27;tothog&#x27;,\n                                                   &#x27;coddig&#x27;, &#x27;numpers&#x27;, &#x27;mi00b&#x27;,\n                                                   &#x27;mo00b&#x27;, &#x27;if3b&#x27;, &#x27;if4b&#x27;,\n                                                   &#x27;if4o&#x27;, &#x27;if5b&#x27;, &#x27;if6b&#x27;,\n                                                   &#x27;if7b&#x27;, &#x27;if8b&#x27;, &#x27;if9b&#x27;,\n                                                   &#x27;if10&#x27;, &#x27;nf12&#x27;, &#x27;n1_flebo&#x27;,\n                                                   &#x27;n2_flebo&#x27;, &#x27;idhog&#x27;, &#x27;idviv&#x27;,\n                                                   &#x27;id...\n                                                                                 max_categories=50,\n                                                                                 sparse_output=False))]),\n                                                  [&#x27;ciudad&#x27;, &#x27;nciudad&#x27;,\n                                                   &#x27;regional&#x27;, &#x27;altitud&#x27;,\n                                                   &#x27;resultad&#x27;, &#x27;informa&#x27;,\n                                                   &#x27;parentes&#x27;, &#x27;codsup&#x27;,\n                                                   &#x27;codenc&#x27;, &#x27;codcod&#x27;,\n                                                   &#x27;supere1&#x27;, &#x27;supere2&#x27;,\n                                                   &#x27;supere3&#x27;, &#x27;superr1&#x27;,\n                                                   &#x27;superr2&#x27;, &#x27;superr3&#x27;,\n                                                   &#x27;supern1&#x27;, &#x27;supern2&#x27;,\n                                                   &#x27;supern3&#x27;, &#x27;dia&#x27;, &#x27;mes&#x27;,\n                                                   &#x27;anio&#x27;, &#x27;mi00a&#x27;, &#x27;mo00a&#x27;,\n                                                   &#x27;if2&#x27;, &#x27;if3a&#x27;, &#x27;if4a&#x27;,\n                                                   &#x27;if5a&#x27;, &#x27;if6a&#x27;, &#x27;if7a&#x27;, ...])])),\n                (&#x27;clf&#x27;, LogisticRegression(max_iter=1000))])</pre><b>In a Jupyter environment, please rerun this cell to show the HTML representation or trust the notebook. <br />On GitHub, the HTML representation is unable to render, please try loading this page with nbviewer.org.</b></div><div class=\"sk-container\" hidden><div class=\"sk-item sk-dashed-wrapped\"><div class=\"sk-label-container\"><div class=\"sk-label fitted sk-toggleable\"><input class=\"sk-toggleable__control sk-hidden--visually\" id=\"sk-estimator-id-1\" type=\"checkbox\" ><label for=\"sk-estimator-id-1\" class=\"sk-toggleable__label fitted sk-toggleable__label-arrow\"><div><div>Pipeline</div></div><div><a class=\"sk-estimator-doc-link fitted\" rel=\"noreferrer\" target=\"_blank\" href=\"https://scikit-learn.org/1.7/modules/generated/sklearn.pipeline.Pipeline.html\">?<span>Documentation for Pipeline</span></a><span class=\"sk-estimator-doc-link fitted\">i<span>Fitted</span></span></div></label><div class=\"sk-toggleable__content fitted\" data-param-prefix=\"\">\n        <div class=\"estimator-table\">\n            <details>\n                <summary>Parameters</summary>\n                <table class=\"parameters-table\">\n                  <tbody>\n                    \n        <tr class=\"user-set\">\n            <td><i class=\"copy-paste-icon\"\n                 onclick=\"copyToClipboard('steps',\n                          this.parentElement.nextElementSibling)\"\n            ></i></td>\n            <td class=\"param\">steps&nbsp;</td>\n            <td class=\"value\">[(&#x27;prep&#x27;, ...), (&#x27;clf&#x27;, ...)]</td>\n        </tr>\n    \n\n        <tr class=\"default\">\n            <td><i class=\"copy-paste-icon\"\n                 onclick=\"copyToClipboard('transform_input',\n                          this.parentElement.nextElementSibling)\"\n            ></i></td>\n            <td class=\"param\">transform_input&nbsp;</td>\n            <td class=\"value\">None</td>\n        </tr>\n    \n\n        <tr class=\"default\">\n            <td><i class=\"copy-paste-icon\"\n                 onclick=\"copyToClipboard('memory',\n                          this.parentElement.nextElementSibling)\"\n            ></i></td>\n            <td class=\"param\">memory&nbsp;</td>\n            <td class=\"value\">None</td>\n        </tr>\n    \n\n        <tr class=\"default\">\n            <td><i class=\"copy-paste-icon\"\n                 onclick=\"copyToClipboard('verbose',\n                          this.parentElement.nextElementSibling)\"\n            ></i></td>\n            <td class=\"param\">verbose&nbsp;</td>\n            <td class=\"value\">False</td>\n        </tr>\n    \n                  </tbody>\n                </table>\n            </details>\n        </div>\n    </div></div></div><div class=\"sk-serial\"><div class=\"sk-item sk-dashed-wrapped\"><div class=\"sk-label-container\"><div class=\"sk-label fitted sk-toggleable\"><input class=\"sk-toggleable__control sk-hidden--visually\" id=\"sk-estimator-id-2\" type=\"checkbox\" ><label for=\"sk-estimator-id-2\" class=\"sk-toggleable__label fitted sk-toggleable__label-arrow\"><div><div>prep: ColumnTransformer</div></div><div><a class=\"sk-estimator-doc-link fitted\" rel=\"noreferrer\" target=\"_blank\" href=\"https://scikit-learn.org/1.7/modules/generated/sklearn.compose.ColumnTransformer.html\">?<span>Documentation for prep: ColumnTransformer</span></a></div></label><div class=\"sk-toggleable__content fitted\" data-param-prefix=\"prep__\">\n        <div class=\"estimator-table\">\n            <details>\n                <summary>Parameters</summary>\n                <table class=\"parameters-table\">\n                  <tbody>\n                    \n        <tr class=\"user-set\">\n            <td><i class=\"copy-paste-icon\"\n                 onclick=\"copyToClipboard('transformers',\n                          this.parentElement.nextElementSibling)\"\n            ></i></td>\n            <td class=\"param\">transformers&nbsp;</td>\n            <td class=\"value\">[(&#x27;num&#x27;, ...), (&#x27;cat&#x27;, ...)]</td>\n        </tr>\n    \n\n        <tr class=\"default\">\n            <td><i class=\"copy-paste-icon\"\n                 onclick=\"copyToClipboard('remainder',\n                          this.parentElement.nextElementSibling)\"\n            ></i></td>\n            <td class=\"param\">remainder&nbsp;</td>\n            <td class=\"value\">&#x27;drop&#x27;</td>\n        </tr>\n    \n\n        <tr class=\"default\">\n            <td><i class=\"copy-paste-icon\"\n                 onclick=\"copyToClipboard('sparse_threshold',\n                          this.parentElement.nextElementSibling)\"\n            ></i></td>\n            <td class=\"param\">sparse_threshold&nbsp;</td>\n            <td class=\"value\">0.3</td>\n        </tr>\n    \n\n        <tr class=\"default\">\n            <td><i class=\"copy-paste-icon\"\n                 onclick=\"copyToClipboard('n_jobs',\n                          this.parentElement.nextElementSibling)\"\n            ></i></td>\n            <td class=\"param\">n_jobs&nbsp;</td>\n            <td class=\"value\">None</td>\n        </tr>\n    \n\n        <tr class=\"default\">\n            <td><i class=\"copy-paste-icon\"\n                 onclick=\"copyToClipboard('transformer_weights',\n                          this.parentElement.nextElementSibling)\"\n            ></i></td>\n            <td class=\"param\">transformer_weights&nbsp;</td>\n            <td class=\"value\">None</td>\n        </tr>\n    \n\n        <tr class=\"default\">\n            <td><i class=\"copy-paste-icon\"\n                 onclick=\"copyToClipboard('verbose',\n                          this.parentElement.nextElementSibling)\"\n            ></i></td>\n            <td class=\"param\">verbose&nbsp;</td>\n            <td class=\"value\">False</td>\n        </tr>\n    \n\n        <tr class=\"default\">\n            <td><i class=\"copy-paste-icon\"\n                 onclick=\"copyToClipboard('verbose_feature_names_out',\n                          this.parentElement.nextElementSibling)\"\n            ></i></td>\n            <td class=\"param\">verbose_feature_names_out&nbsp;</td>\n            <td class=\"value\">True</td>\n        </tr>\n    \n\n        <tr class=\"default\">\n            <td><i class=\"copy-paste-icon\"\n                 onclick=\"copyToClipboard('force_int_remainder_cols',\n                          this.parentElement.nextElementSibling)\"\n            ></i></td>\n            <td class=\"param\">force_int_remainder_cols&nbsp;</td>\n            <td class=\"value\">&#x27;deprecated&#x27;</td>\n        </tr>\n    \n                  </tbody>\n                </table>\n            </details>\n        </div>\n    </div></div></div><div class=\"sk-parallel\"><div class=\"sk-parallel-item\"><div class=\"sk-item\"><div class=\"sk-label-container\"><div class=\"sk-label fitted sk-toggleable\"><input class=\"sk-toggleable__control sk-hidden--visually\" id=\"sk-estimator-id-3\" type=\"checkbox\" ><label for=\"sk-estimator-id-3\" class=\"sk-toggleable__label fitted sk-toggleable__label-arrow\"><div><div>num</div></div></label><div class=\"sk-toggleable__content fitted\" data-param-prefix=\"prep__num__\"><pre>[&#x27;zona&#x27;, &#x27;sector&#x27;, &#x27;vivienda&#x27;, &#x27;hogar&#x27;, &#x27;vo&#x27;, &#x27;tothog&#x27;, &#x27;coddig&#x27;, &#x27;numpers&#x27;, &#x27;mi00b&#x27;, &#x27;mo00b&#x27;, &#x27;if3b&#x27;, &#x27;if4b&#x27;, &#x27;if4o&#x27;, &#x27;if5b&#x27;, &#x27;if6b&#x27;, &#x27;if7b&#x27;, &#x27;if8b&#x27;, &#x27;if9b&#x27;, &#x27;if10&#x27;, &#x27;nf12&#x27;, &#x27;n1_flebo&#x27;, &#x27;n2_flebo&#x27;, &#x27;idhog&#x27;, &#x27;idviv&#x27;, &#x27;idsector&#x27;]</pre></div></div></div><div class=\"sk-serial\"><div class=\"sk-item\"><div class=\"sk-serial\"><div class=\"sk-item\"><div class=\"sk-estimator fitted sk-toggleable\"><input class=\"sk-toggleable__control sk-hidden--visually\" id=\"sk-estimator-id-4\" type=\"checkbox\" ><label for=\"sk-estimator-id-4\" class=\"sk-toggleable__label fitted sk-toggleable__label-arrow\"><div><div>SimpleImputer</div></div><div><a class=\"sk-estimator-doc-link fitted\" rel=\"noreferrer\" target=\"_blank\" href=\"https://scikit-learn.org/1.7/modules/generated/sklearn.impute.SimpleImputer.html\">?<span>Documentation for SimpleImputer</span></a></div></label><div class=\"sk-toggleable__content fitted\" data-param-prefix=\"prep__num__imputer__\">\n        <div class=\"estimator-table\">\n            <details>\n                <summary>Parameters</summary>\n                <table class=\"parameters-table\">\n                  <tbody>\n                    \n        <tr class=\"default\">\n            <td><i class=\"copy-paste-icon\"\n                 onclick=\"copyToClipboard('missing_values',\n                          this.parentElement.nextElementSibling)\"\n            ></i></td>\n            <td class=\"param\">missing_values&nbsp;</td>\n            <td class=\"value\">nan</td>\n        </tr>\n    \n\n        <tr class=\"user-set\">\n            <td><i class=\"copy-paste-icon\"\n                 onclick=\"copyToClipboard('strategy',\n                          this.parentElement.nextElementSibling)\"\n            ></i></td>\n            <td class=\"param\">strategy&nbsp;</td>\n            <td class=\"value\">&#x27;median&#x27;</td>\n        </tr>\n    \n\n        <tr class=\"default\">\n            <td><i class=\"copy-paste-icon\"\n                 onclick=\"copyToClipboard('fill_value',\n                          this.parentElement.nextElementSibling)\"\n            ></i></td>\n            <td class=\"param\">fill_value&nbsp;</td>\n            <td class=\"value\">None</td>\n        </tr>\n    \n\n        <tr class=\"default\">\n            <td><i class=\"copy-paste-icon\"\n                 onclick=\"copyToClipboard('copy',\n                          this.parentElement.nextElementSibling)\"\n            ></i></td>\n            <td class=\"param\">copy&nbsp;</td>\n            <td class=\"value\">True</td>\n        </tr>\n    \n\n        <tr class=\"default\">\n            <td><i class=\"copy-paste-icon\"\n                 onclick=\"copyToClipboard('add_indicator',\n                          this.parentElement.nextElementSibling)\"\n            ></i></td>\n            <td class=\"param\">add_indicator&nbsp;</td>\n            <td class=\"value\">False</td>\n        </tr>\n    \n\n        <tr class=\"default\">\n            <td><i class=\"copy-paste-icon\"\n                 onclick=\"copyToClipboard('keep_empty_features',\n                          this.parentElement.nextElementSibling)\"\n            ></i></td>\n            <td class=\"param\">keep_empty_features&nbsp;</td>\n            <td class=\"value\">False</td>\n        </tr>\n    \n                  </tbody>\n                </table>\n            </details>\n        </div>\n    </div></div></div><div class=\"sk-item\"><div class=\"sk-estimator fitted sk-toggleable\"><input class=\"sk-toggleable__control sk-hidden--visually\" id=\"sk-estimator-id-5\" type=\"checkbox\" ><label for=\"sk-estimator-id-5\" class=\"sk-toggleable__label fitted sk-toggleable__label-arrow\"><div><div>StandardScaler</div></div><div><a class=\"sk-estimator-doc-link fitted\" rel=\"noreferrer\" target=\"_blank\" href=\"https://scikit-learn.org/1.7/modules/generated/sklearn.preprocessing.StandardScaler.html\">?<span>Documentation for StandardScaler</span></a></div></label><div class=\"sk-toggleable__content fitted\" data-param-prefix=\"prep__num__scaler__\">\n        <div class=\"estimator-table\">\n            <details>\n                <summary>Parameters</summary>\n                <table class=\"parameters-table\">\n                  <tbody>\n                    \n        <tr class=\"default\">\n            <td><i class=\"copy-paste-icon\"\n                 onclick=\"copyToClipboard('copy',\n                          this.parentElement.nextElementSibling)\"\n            ></i></td>\n            <td class=\"param\">copy&nbsp;</td>\n            <td class=\"value\">True</td>\n        </tr>\n    \n\n        <tr class=\"default\">\n            <td><i class=\"copy-paste-icon\"\n                 onclick=\"copyToClipboard('with_mean',\n                          this.parentElement.nextElementSibling)\"\n            ></i></td>\n            <td class=\"param\">with_mean&nbsp;</td>\n            <td class=\"value\">True</td>\n        </tr>\n    \n\n        <tr class=\"default\">\n            <td><i class=\"copy-paste-icon\"\n                 onclick=\"copyToClipboard('with_std',\n                          this.parentElement.nextElementSibling)\"\n            ></i></td>\n            <td class=\"param\">with_std&nbsp;</td>\n            <td class=\"value\">True</td>\n        </tr>\n    \n                  </tbody>\n                </table>\n            </details>\n        </div>\n    </div></div></div></div></div></div></div></div><div class=\"sk-parallel-item\"><div class=\"sk-item\"><div class=\"sk-label-container\"><div class=\"sk-label fitted sk-toggleable\"><input class=\"sk-toggleable__control sk-hidden--visually\" id=\"sk-estimator-id-6\" type=\"checkbox\" ><label for=\"sk-estimator-id-6\" class=\"sk-toggleable__label fitted sk-toggleable__label-arrow\"><div><div>cat</div></div></label><div class=\"sk-toggleable__content fitted\" data-param-prefix=\"prep__cat__\"><pre>[&#x27;ciudad&#x27;, &#x27;nciudad&#x27;, &#x27;regional&#x27;, &#x27;altitud&#x27;, &#x27;resultad&#x27;, &#x27;informa&#x27;, &#x27;parentes&#x27;, &#x27;codsup&#x27;, &#x27;codenc&#x27;, &#x27;codcod&#x27;, &#x27;supere1&#x27;, &#x27;supere2&#x27;, &#x27;supere3&#x27;, &#x27;superr1&#x27;, &#x27;superr2&#x27;, &#x27;superr3&#x27;, &#x27;supern1&#x27;, &#x27;supern2&#x27;, &#x27;supern3&#x27;, &#x27;dia&#x27;, &#x27;mes&#x27;, &#x27;anio&#x27;, &#x27;mi00a&#x27;, &#x27;mo00a&#x27;, &#x27;if2&#x27;, &#x27;if3a&#x27;, &#x27;if4a&#x27;, &#x27;if5a&#x27;, &#x27;if6a&#x27;, &#x27;if7a&#x27;, &#x27;if8a&#x27;, &#x27;if9a&#x27;, &#x27;pw&#x27;]</pre></div></div></div><div class=\"sk-serial\"><div class=\"sk-item\"><div class=\"sk-serial\"><div class=\"sk-item\"><div class=\"sk-estimator fitted sk-toggleable\"><input class=\"sk-toggleable__control sk-hidden--visually\" id=\"sk-estimator-id-7\" type=\"checkbox\" ><label for=\"sk-estimator-id-7\" class=\"sk-toggleable__label fitted sk-toggleable__label-arrow\"><div><div>SimpleImputer</div></div><div><a class=\"sk-estimator-doc-link fitted\" rel=\"noreferrer\" target=\"_blank\" href=\"https://scikit-learn.org/1.7/modules/generated/sklearn.impute.SimpleImputer.html\">?<span>Documentation for SimpleImputer</span></a></div></label><div class=\"sk-toggleable__content fitted\" data-param-prefix=\"prep__cat__imputer__\">\n        <div class=\"estimator-table\">\n            <details>\n                <summary>Parameters</summary>\n                <table class=\"parameters-table\">\n                  <tbody>\n                    \n        <tr class=\"default\">\n            <td><i class=\"copy-paste-icon\"\n                 onclick=\"copyToClipboard('missing_values',\n                          this.parentElement.nextElementSibling)\"\n            ></i></td>\n            <td class=\"param\">missing_values&nbsp;</td>\n            <td class=\"value\">nan</td>\n        </tr>\n    \n\n        <tr class=\"user-set\">\n            <td><i class=\"copy-paste-icon\"\n                 onclick=\"copyToClipboard('strategy',\n                          this.parentElement.nextElementSibling)\"\n            ></i></td>\n            <td class=\"param\">strategy&nbsp;</td>\n            <td class=\"value\">&#x27;most_frequent&#x27;</td>\n        </tr>\n    \n\n        <tr class=\"default\">\n            <td><i class=\"copy-paste-icon\"\n                 onclick=\"copyToClipboard('fill_value',\n                          this.parentElement.nextElementSibling)\"\n            ></i></td>\n            <td class=\"param\">fill_value&nbsp;</td>\n            <td class=\"value\">None</td>\n        </tr>\n    \n\n        <tr class=\"default\">\n            <td><i class=\"copy-paste-icon\"\n                 onclick=\"copyToClipboard('copy',\n                          this.parentElement.nextElementSibling)\"\n            ></i></td>\n            <td class=\"param\">copy&nbsp;</td>\n            <td class=\"value\">True</td>\n        </tr>\n    \n\n        <tr class=\"default\">\n            <td><i class=\"copy-paste-icon\"\n                 onclick=\"copyToClipboard('add_indicator',\n                          this.parentElement.nextElementSibling)\"\n            ></i></td>\n            <td class=\"param\">add_indicator&nbsp;</td>\n            <td class=\"value\">False</td>\n        </tr>\n    \n\n        <tr class=\"default\">\n            <td><i class=\"copy-paste-icon\"\n                 onclick=\"copyToClipboard('keep_empty_features',\n                          this.parentElement.nextElementSibling)\"\n            ></i></td>\n            <td class=\"param\">keep_empty_features&nbsp;</td>\n            <td class=\"value\">False</td>\n        </tr>\n    \n                  </tbody>\n                </table>\n            </details>\n        </div>\n    </div></div></div><div class=\"sk-item\"><div class=\"sk-estimator fitted sk-toggleable\"><input class=\"sk-toggleable__control sk-hidden--visually\" id=\"sk-estimator-id-8\" type=\"checkbox\" ><label for=\"sk-estimator-id-8\" class=\"sk-toggleable__label fitted sk-toggleable__label-arrow\"><div><div>OneHotEncoder</div></div><div><a class=\"sk-estimator-doc-link fitted\" rel=\"noreferrer\" target=\"_blank\" href=\"https://scikit-learn.org/1.7/modules/generated/sklearn.preprocessing.OneHotEncoder.html\">?<span>Documentation for OneHotEncoder</span></a></div></label><div class=\"sk-toggleable__content fitted\" data-param-prefix=\"prep__cat__onehot__\">\n        <div class=\"estimator-table\">\n            <details>\n                <summary>Parameters</summary>\n                <table class=\"parameters-table\">\n                  <tbody>\n                    \n        <tr class=\"default\">\n            <td><i class=\"copy-paste-icon\"\n                 onclick=\"copyToClipboard('categories',\n                          this.parentElement.nextElementSibling)\"\n            ></i></td>\n            <td class=\"param\">categories&nbsp;</td>\n            <td class=\"value\">&#x27;auto&#x27;</td>\n        </tr>\n    \n\n        <tr class=\"default\">\n            <td><i class=\"copy-paste-icon\"\n                 onclick=\"copyToClipboard('drop',\n                          this.parentElement.nextElementSibling)\"\n            ></i></td>\n            <td class=\"param\">drop&nbsp;</td>\n            <td class=\"value\">None</td>\n        </tr>\n    \n\n        <tr class=\"user-set\">\n            <td><i class=\"copy-paste-icon\"\n                 onclick=\"copyToClipboard('sparse_output',\n                          this.parentElement.nextElementSibling)\"\n            ></i></td>\n            <td class=\"param\">sparse_output&nbsp;</td>\n            <td class=\"value\">False</td>\n        </tr>\n    \n\n        <tr class=\"default\">\n            <td><i class=\"copy-paste-icon\"\n                 onclick=\"copyToClipboard('dtype',\n                          this.parentElement.nextElementSibling)\"\n            ></i></td>\n            <td class=\"param\">dtype&nbsp;</td>\n            <td class=\"value\">&lt;class &#x27;numpy.float64&#x27;&gt;</td>\n        </tr>\n    \n\n        <tr class=\"user-set\">\n            <td><i class=\"copy-paste-icon\"\n                 onclick=\"copyToClipboard('handle_unknown',\n                          this.parentElement.nextElementSibling)\"\n            ></i></td>\n            <td class=\"param\">handle_unknown&nbsp;</td>\n            <td class=\"value\">&#x27;ignore&#x27;</td>\n        </tr>\n    \n\n        <tr class=\"default\">\n            <td><i class=\"copy-paste-icon\"\n                 onclick=\"copyToClipboard('min_frequency',\n                          this.parentElement.nextElementSibling)\"\n            ></i></td>\n            <td class=\"param\">min_frequency&nbsp;</td>\n            <td class=\"value\">None</td>\n        </tr>\n    \n\n        <tr class=\"user-set\">\n            <td><i class=\"copy-paste-icon\"\n                 onclick=\"copyToClipboard('max_categories',\n                          this.parentElement.nextElementSibling)\"\n            ></i></td>\n            <td class=\"param\">max_categories&nbsp;</td>\n            <td class=\"value\">50</td>\n        </tr>\n    \n\n        <tr class=\"default\">\n            <td><i class=\"copy-paste-icon\"\n                 onclick=\"copyToClipboard('feature_name_combiner',\n                          this.parentElement.nextElementSibling)\"\n            ></i></td>\n            <td class=\"param\">feature_name_combiner&nbsp;</td>\n            <td class=\"value\">&#x27;concat&#x27;</td>\n        </tr>\n    \n                  </tbody>\n                </table>\n            </details>\n        </div>\n    </div></div></div></div></div></div></div></div></div></div><div class=\"sk-item\"><div class=\"sk-estimator fitted sk-toggleable\"><input class=\"sk-toggleable__control sk-hidden--visually\" id=\"sk-estimator-id-9\" type=\"checkbox\" ><label for=\"sk-estimator-id-9\" class=\"sk-toggleable__label fitted sk-toggleable__label-arrow\"><div><div>LogisticRegression</div></div><div><a class=\"sk-estimator-doc-link fitted\" rel=\"noreferrer\" target=\"_blank\" href=\"https://scikit-learn.org/1.7/modules/generated/sklearn.linear_model.LogisticRegression.html\">?<span>Documentation for LogisticRegression</span></a></div></label><div class=\"sk-toggleable__content fitted\" data-param-prefix=\"clf__\">\n        <div class=\"estimator-table\">\n            <details>\n                <summary>Parameters</summary>\n                <table class=\"parameters-table\">\n                  <tbody>\n                    \n        <tr class=\"default\">\n            <td><i class=\"copy-paste-icon\"\n                 onclick=\"copyToClipboard('penalty',\n                          this.parentElement.nextElementSibling)\"\n            ></i></td>\n            <td class=\"param\">penalty&nbsp;</td>\n            <td class=\"value\">&#x27;l2&#x27;</td>\n        </tr>\n    \n\n        <tr class=\"default\">\n            <td><i class=\"copy-paste-icon\"\n                 onclick=\"copyToClipboard('dual',\n                          this.parentElement.nextElementSibling)\"\n            ></i></td>\n            <td class=\"param\">dual&nbsp;</td>\n            <td class=\"value\">False</td>\n        </tr>\n    \n\n        <tr class=\"default\">\n            <td><i class=\"copy-paste-icon\"\n                 onclick=\"copyToClipboard('tol',\n                          this.parentElement.nextElementSibling)\"\n            ></i></td>\n            <td class=\"param\">tol&nbsp;</td>\n            <td class=\"value\">0.0001</td>\n        </tr>\n    \n\n        <tr class=\"default\">\n            <td><i class=\"copy-paste-icon\"\n                 onclick=\"copyToClipboard('C',\n                          this.parentElement.nextElementSibling)\"\n            ></i></td>\n            <td class=\"param\">C&nbsp;</td>\n            <td class=\"value\">1.0</td>\n        </tr>\n    \n\n        <tr class=\"default\">\n            <td><i class=\"copy-paste-icon\"\n                 onclick=\"copyToClipboard('fit_intercept',\n                          this.parentElement.nextElementSibling)\"\n            ></i></td>\n            <td class=\"param\">fit_intercept&nbsp;</td>\n            <td class=\"value\">True</td>\n        </tr>\n    \n\n        <tr class=\"default\">\n            <td><i class=\"copy-paste-icon\"\n                 onclick=\"copyToClipboard('intercept_scaling',\n                          this.parentElement.nextElementSibling)\"\n            ></i></td>\n            <td class=\"param\">intercept_scaling&nbsp;</td>\n            <td class=\"value\">1</td>\n        </tr>\n    \n\n        <tr class=\"default\">\n            <td><i class=\"copy-paste-icon\"\n                 onclick=\"copyToClipboard('class_weight',\n                          this.parentElement.nextElementSibling)\"\n            ></i></td>\n            <td class=\"param\">class_weight&nbsp;</td>\n            <td class=\"value\">None</td>\n        </tr>\n    \n\n        <tr class=\"default\">\n            <td><i class=\"copy-paste-icon\"\n                 onclick=\"copyToClipboard('random_state',\n                          this.parentElement.nextElementSibling)\"\n            ></i></td>\n            <td class=\"param\">random_state&nbsp;</td>\n            <td class=\"value\">None</td>\n        </tr>\n    \n\n        <tr class=\"default\">\n            <td><i class=\"copy-paste-icon\"\n                 onclick=\"copyToClipboard('solver',\n                          this.parentElement.nextElementSibling)\"\n            ></i></td>\n            <td class=\"param\">solver&nbsp;</td>\n            <td class=\"value\">&#x27;lbfgs&#x27;</td>\n        </tr>\n    \n\n        <tr class=\"user-set\">\n            <td><i class=\"copy-paste-icon\"\n                 onclick=\"copyToClipboard('max_iter',\n                          this.parentElement.nextElementSibling)\"\n            ></i></td>\n            <td class=\"param\">max_iter&nbsp;</td>\n            <td class=\"value\">1000</td>\n        </tr>\n    \n\n        <tr class=\"default\">\n            <td><i class=\"copy-paste-icon\"\n                 onclick=\"copyToClipboard('multi_class',\n                          this.parentElement.nextElementSibling)\"\n            ></i></td>\n            <td class=\"param\">multi_class&nbsp;</td>\n            <td class=\"value\">&#x27;deprecated&#x27;</td>\n        </tr>\n    \n\n        <tr class=\"default\">\n            <td><i class=\"copy-paste-icon\"\n                 onclick=\"copyToClipboard('verbose',\n                          this.parentElement.nextElementSibling)\"\n            ></i></td>\n            <td class=\"param\">verbose&nbsp;</td>\n            <td class=\"value\">0</td>\n        </tr>\n    \n\n        <tr class=\"default\">\n            <td><i class=\"copy-paste-icon\"\n                 onclick=\"copyToClipboard('warm_start',\n                          this.parentElement.nextElementSibling)\"\n            ></i></td>\n            <td class=\"param\">warm_start&nbsp;</td>\n            <td class=\"value\">False</td>\n        </tr>\n    \n\n        <tr class=\"default\">\n            <td><i class=\"copy-paste-icon\"\n                 onclick=\"copyToClipboard('n_jobs',\n                          this.parentElement.nextElementSibling)\"\n            ></i></td>\n            <td class=\"param\">n_jobs&nbsp;</td>\n            <td class=\"value\">None</td>\n        </tr>\n    \n\n        <tr class=\"default\">\n            <td><i class=\"copy-paste-icon\"\n                 onclick=\"copyToClipboard('l1_ratio',\n                          this.parentElement.nextElementSibling)\"\n            ></i></td>\n            <td class=\"param\">l1_ratio&nbsp;</td>\n            <td class=\"value\">None</td>\n        </tr>\n    \n                  </tbody>\n                </table>\n            </details>\n        </div>\n    </div></div></div></div></div></div></div><script>function copyToClipboard(text, element) {\n    // Get the parameter prefix from the closest toggleable content\n    const toggleableContent = element.closest('.sk-toggleable__content');\n    const paramPrefix = toggleableContent ? toggleableContent.dataset.paramPrefix : '';\n    const fullParamName = paramPrefix ? `${paramPrefix}${text}` : text;\n\n    const originalStyle = element.style;\n    const computedStyle = window.getComputedStyle(element);\n    const originalWidth = computedStyle.width;\n    const originalHTML = element.innerHTML.replace('Copied!', '');\n\n    navigator.clipboard.writeText(fullParamName)\n        .then(() => {\n            element.style.width = originalWidth;\n            element.style.color = 'green';\n            element.innerHTML = \"Copied!\";\n\n            setTimeout(() => {\n                element.innerHTML = originalHTML;\n                element.style = originalStyle;\n            }, 2000);\n        })\n        .catch(err => {\n            console.error('Failed to copy:', err);\n            element.style.color = 'red';\n            element.innerHTML = \"Failed!\";\n            setTimeout(() => {\n                element.innerHTML = originalHTML;\n                element.style = originalStyle;\n            }, 2000);\n        });\n    return false;\n}\n\ndocument.querySelectorAll('.fa-regular.fa-copy').forEach(function(element) {\n    const toggleableContent = element.closest('.sk-toggleable__content');\n    const paramPrefix = toggleableContent ? toggleableContent.dataset.paramPrefix : '';\n    const paramName = element.parentElement.nextElementSibling.textContent.trim();\n    const fullParamName = paramPrefix ? `${paramPrefix}${paramName}` : paramName;\n\n    element.setAttribute('title', fullParamName);\n});\n</script></body>\n```\n:::\n:::\n\n\n## 5) Predicciones y métricas\n\n::: {#9374eddd .cell execution_count=9}\n``` {.python .cell-code}\nfrom sklearn.metrics import accuracy_score, precision_score, recall_score, f1_score, classification_report\n\ny_pred = model.predict(X_test)\n\n# definir clase positiva como la \"mayor\" por orden (ajústalo si prefieres otra)\npos_label = sorted(y_test.unique())[-1]\n\nacc = accuracy_score(y_test, y_pred)\nprec = precision_score(y_test, y_pred, pos_label=pos_label)\nrec = recall_score(y_test, y_pred, pos_label=pos_label)\nf1 = f1_score(y_test, y_pred, pos_label=pos_label)\n\nacc, prec, rec, f1\n```\n\n::: {.cell-output .cell-output-display execution_count=9}\n```\n(0.98989898989899, 0.9890806622050018, 0.9943342776203966, 0.9917005120960621)\n```\n:::\n:::\n\n\n::: {#e1e59487 .cell execution_count=10}\n``` {.python .cell-code}\nprint(classification_report(y_test, y_pred))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n              precision    recall  f1-score   support\n\n       rural       0.99      0.98      0.99      1829\n      urbano       0.99      0.99      0.99      2824\n\n    accuracy                           0.99      4653\n   macro avg       0.99      0.99      0.99      4653\nweighted avg       0.99      0.99      0.99      4653\n\n```\n:::\n:::\n\n\n## 6) Matriz de confusión (visualización)\n\n::: {#7c29267a .cell execution_count=11}\n``` {.python .cell-code}\nfrom sklearn.metrics import confusion_matrix\nimport numpy as np\nimport matplotlib.pyplot as plt\n\nlabels = sorted(y_test.unique())\ncm = confusion_matrix(y_test, y_pred, labels=labels)\n\nfig, ax = plt.subplots(figsize=(4.5,4))\nim = ax.imshow(cm, cmap=\"Blues\")\nax.set_title(\"Matriz de confusión\")\nax.set_xlabel(\"Predicha\")\nax.set_ylabel(\"Real\")\nax.set_xticks(range(len(labels))); ax.set_xticklabels(labels, rotation=0)\nax.set_yticks(range(len(labels))); ax.set_yticklabels(labels)\nfor i in range(cm.shape[0]):\n    for j in range(cm.shape[1]):\n        ax.text(j, i, cm[i, j], ha=\"center\", va=\"center\")\nfig.colorbar(im)\nplt.tight_layout()\nplt.show()\n```\n\n::: {.cell-output .cell-output-display}\n![](index_classification_files/figure-html/cell-12-output-1.png){width=425 height=349}\n:::\n:::\n\n\n## 7) Curva ROC y AUC\n\n::: {#2706450b .cell execution_count=12}\n``` {.python .cell-code}\nfrom sklearn.metrics import roc_curve, auc\n\npos_label = sorted(y_train.unique())[-1]\ny_proba = model.predict_proba(X_test)[:, list(model.classes_).index(pos_label)]\n\nfpr, tpr, thr = roc_curve(y_test, y_proba, pos_label=pos_label)\nroc_auc = auc(fpr, tpr)\n\nplt.figure(figsize=(5,4))\nplt.plot(fpr, tpr, label=f\"ROC (AUC = {roc_auc:.3f})\")\nplt.plot([0,1],[0,1], \"--\", alpha=0.6)\nplt.xlabel(\"False Positive Rate\")\nplt.ylabel(\"True Positive Rate\")\nplt.title(\"Curva ROC\")\nplt.legend()\nplt.tight_layout()\nplt.show()\n\nroc_auc\n```\n\n::: {.cell-output .cell-output-display}\n![](index_classification_files/figure-html/cell-13-output-1.png){width=470 height=374}\n:::\n\n::: {.cell-output .cell-output-display execution_count=12}\n```\n0.9995856804984844\n```\n:::\n:::\n\n\n## 8) Discusión de resultados\n\n- **Accuracy / Precision / Recall / F1**: interpreta cada métrica según el costo de errores.\n- **Matriz de confusión**: identifica dónde se equivoca más el modelo.\n- **ROC/AUC**: valores cercanos a 1 indican mejor discriminación; ~0.5 es aleatorio.\n- Si el desempeño es bajo: prueba `class_weight='balanced'`, regularización (ajustar `C`), ingeniería de variables o modelos alternativos (árboles, ensambles).\n\n",
    "supporting": [
      "index_classification_files"
    ],
    "filters": [],
    "includes": {
      "include-in-header": [
        "<script src=\"https://cdn.jsdelivr.net/npm/requirejs@2.3.6/require.min.js\" integrity=\"sha384-c9c+LnTbwQ3aujuU7ULEPVvgLs+Fn6fJUvIGTsuu1ZcCf11fiEubah0ttpca4ntM sha384-6V1/AdqZRWk1KAlWbKBlGhN7VG4iE/yAZcO6NZPMF8od0vukrvr0tg4qY6NSrItx\" crossorigin=\"anonymous\"></script>\n<script src=\"https://cdn.jsdelivr.net/npm/jquery@3.5.1/dist/jquery.min.js\" integrity=\"sha384-ZvpUoO/+PpLXR1lu4jmpXWu80pZlYUAfxl5NsBMWOEPSjUn/6Z/hRTt8+pR6L4N2\" crossorigin=\"anonymous\" data-relocate-top=\"true\"></script>\n<script type=\"application/javascript\">define('jquery', [],function() {return window.jQuery;})</script>\n"
      ]
    }
  }
}